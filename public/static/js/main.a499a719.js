(()=>{"use strict";var e={5208:(e,t,r)=>{r.r(t),r.d(t,{default:()=>F});var a=r(8548),o=r(5069),n=r(4929),l=r(8597),s=r(2503),i=r(3052),d=r(5564),c=r(2892),f=r(7062),u=r(4609),b=r(3742),p=r(3033),g=r(2144),h=r(2517),y=r(1973),m=r(5080);const j=(0,r(643).initializeApp)({apiKey:"AIzaSyCsb3TAGK_FLv7rn5hlEwDq6asH6qWzuSA",authDomain:"sbabadag1.firebaseapp.com",databaseURL:"https://sbabadag1-default-rtdb.europe-west1.firebasedatabase.app",projectId:"sbabadag1",storageBucket:"sbabadag1.appspot.com",messagingSenderId:"25031637223",appId:"1:25031637223:web:99256b91a575120d92ca42",measurementId:"G-87LWBM821R"}),x=(0,m.getDatabase)(j);var C=r(6232);const S=d.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",padding:16,backgroundColor:"#f5f5f5"},label:{fontSize:16,fontWeight:"bold",marginBottom:10},button:{backgroundColor:"#007bff",padding:10,borderRadius:5,marginBottom:20,width:"80%",alignItems:"center"},buttonText:{color:"#ffffff",fontSize:16},tableContainer:{width:"100%",marginTop:20,flex:1},scrollContent:{flexGrow:1},table:{width:p.default.get("window").width-32,borderWidth:1,borderColor:"#cccccc",borderRadius:5,backgroundColor:"#ffffff"},tableRow:{flexDirection:"row",flex:1},tableCell:{flex:1,textAlign:"center",fontSize:14,color:"#333333",padding:10,borderRightWidth:1,borderRightColor:"#cccccc",borderBottomWidth:1,borderBottomColor:"#cccccc",justifyContent:"center",alignItems:"center"},tableHeader:{flex:1,backgroundColor:"#f0f0f0",fontWeight:"bold",justifyContent:"center",alignItems:"center",color:"red",padding:10,borderRightWidth:1,borderRightColor:"#cccccc",borderBottomWidth:1,borderBottomColor:"#cccccc"},separator:{height:1,backgroundColor:"#cccccc",width:"100%"},picker:{height:50,width:"80%",marginBottom:20,marginTop:10},progressContainer:{width:"80%",marginBottom:20,alignItems:"center"},progressBar:{width:"100%",height:10},pdfButton:{backgroundColor:"#007bff",padding:5,borderRadius:5},pdfButtonDisabled:{backgroundColor:"#cccccc"},pdfButtonText:{color:"#ffffff",fontSize:14},loadingContainer:{position:"absolute",top:"50%",left:"50%",transform:[{translateX:-50},{translateY:-50}],alignItems:"center"},paginationContainer:{flexDirection:"row",justifyContent:"space-between",width:"80%",marginTop:20},pageIndicator:{fontSize:16,fontWeight:"bold"}}),w=({navigation:e,route:t})=>{const[r,o]=(0,a.useState)([]),[n,d]=(0,a.useState)(""),[p,j]=(0,a.useState)([]),[w,P]=(0,a.useState)(!1),[v,O]=(0,a.useState)(1),[R,k]=(0,a.useState)(!1),[I,B]=(0,a.useState)(1),[F,T]=(0,a.useState)(0),[D,N]=(0,a.useState)(0);(0,a.useEffect)((()=>{const e=(0,m.ref)(x,"projects/");(0,m.onValue)(e,(e=>{const r=e.val();if(r){const e=Object.keys(r).map((e=>Object.assign({id:e},r[e])));o(e),t.params?.projectId&&W(t.params.projectId)}}))}),[t.params?.projectId]);const W=e=>{if(d(e),""===e.trim())j([]),T(0),N(0);else{const t=r.find((t=>t.id===e));if(t){const e=5;j(t.records.slice(0,e)),O(1),B(Math.ceil(t.records.length/e)),T(t.records.reduce(((e,t)=>e+parseFloat(t.Quantity||0)),0)),N(t.records.reduce(((e,t)=>e+parseFloat(t.QuantityDone||0)),0))}}},H=e=>{if(!R&&n){k(!0);const t="next"===e?v+1:v-1,a=5*(t-1),o=r.find((e=>e.id===n));if(o){const e=o.records.slice(a,a+5);j(e),O(t)}k(!1)}},z=(e,t,a)=>{const o=[...p];o[e][t]=a,j(o);const l=(0,m.ref)(x,`projects/${n}/records/${e}`);(0,m.update)(l,{[t]:a});const s=r.find((e=>e.id===n));s&&(T(s.records.reduce(((e,t)=>e+parseFloat(t.Quantity||0)),0)),N(s.records.reduce(((e,t)=>e+parseFloat(t.QuantityDone||0)),0)))},L=()=>F?D/F:0,Q=({item:e,index:t})=>(0,C.jsxs)(l.default,{style:S.tableRow,children:[(0,C.jsx)(u.default,{style:S.tableCell,value:e.QuantityDone?.toString()||"",onChangeText:e=>z(t,"QuantityDone",e),keyboardType:"numeric"}),(0,C.jsx)(u.default,{style:S.tableCell,value:e.QuantitySent?.toString()||"",onChangeText:e=>z(t,"QuantitySent",e),keyboardType:"numeric"}),(0,C.jsx)(s.default,{style:S.tableCell,children:e.POSNO}),(0,C.jsx)(s.default,{style:S.tableCell,children:e.Quantity}),(0,C.jsx)(s.default,{style:S.tableCell,children:e.Profile}),(0,C.jsx)(s.default,{style:S.tableCell,children:e.Weight}),(0,C.jsx)(i.default,{style:[S.pdfButton,!e.PdfFileURL&&S.pdfButtonDisabled],onPress:()=>(async e=>{P(!0);try{await c.default.openURL(e)}catch(t){console.error("Failed to open URL:",t)}finally{P(!1)}})(e.PdfFileURL),disabled:!e.PdfFileURL,children:(0,C.jsx)(s.default,{style:S.pdfButtonText,children:"Open PDF"})})]});return(0,C.jsxs)(l.default,{style:S.container,children:[(0,C.jsx)(s.default,{style:S.label,children:"Select Project"}),(0,C.jsxs)(h.Picker,{selectedValue:n,style:S.picker,onValueChange:e=>W(e),children:[(0,C.jsx)(h.Picker.Item,{label:"Select Project",value:""}),r.map((e=>(0,C.jsx)(h.Picker.Item,{label:e.projectName,value:e.id},e.id)))]}),(0,C.jsxs)(l.default,{style:S.progressContainer,children:[(0,C.jsxs)(s.default,{children:["Progress: ",Math.round(100*L()),"%"]}),(0,C.jsx)(y.default,{progress:L(),style:S.progressBar})]}),(0,C.jsxs)(b.default,{style:S.tableContainer,contentContainerStyle:S.scrollContent,children:[(0,C.jsxs)(l.default,{style:S.tableRow,children:[(0,C.jsx)(s.default,{style:[S.tableCell,S.tableHeader],children:"Quantity Done"}),(0,C.jsx)(s.default,{style:[S.tableCell,S.tableHeader],children:"Quantity Sent"}),(0,C.jsx)(s.default,{style:[S.tableCell,S.tableHeader],children:"POSNO"}),(0,C.jsx)(s.default,{style:[S.tableCell,S.tableHeader],children:"Quantity"}),(0,C.jsx)(s.default,{style:[S.tableCell,S.tableHeader],children:"Profile"}),(0,C.jsx)(s.default,{style:[S.tableCell,S.tableHeader],children:"Weight"}),(0,C.jsx)(s.default,{style:[S.tableCell,S.tableHeader],children:"PDF"})]}),p.map(((e,t)=>Q({item:e,index:t}))),R&&(0,C.jsx)(f.default,{size:"large",color:"#007bff"})]}),(0,C.jsxs)(l.default,{style:S.paginationContainer,children:[(0,C.jsx)(g.default,{title:"Previous",onPress:()=>H("prev"),disabled:1===v}),(0,C.jsxs)(s.default,{style:S.pageIndicator,children:[v,"/",I]}),(0,C.jsx)(g.default,{title:"Next",onPress:()=>H("next"),disabled:v===I})]}),w&&(0,C.jsxs)(l.default,{style:S.loadingContainer,children:[(0,C.jsx)(f.default,{size:"large",color:"#007bff"}),(0,C.jsx)(s.default,{children:"Loading PDF..."})]})]})};var P=r(4430),v=r(6760),O=r(2526);const R=d.default.create({container:{flexGrow:1,justifyContent:"center",alignItems:"center",padding:16,backgroundColor:"#f5f5f5"},button:{backgroundColor:"#007bff",padding:10,borderRadius:5,marginBottom:20,width:"80%",alignItems:"center"},buttonText:{color:"#ffffff",fontSize:16},fileInput:{marginBottom:20,padding:10,borderWidth:1,borderColor:"#cccccc",borderRadius:5,backgroundColor:"#ffffff"},input:{height:40,borderColor:"#cccccc",borderWidth:1,marginBottom:20,paddingHorizontal:10,width:"80%",borderRadius:5,backgroundColor:"#ffffff"},progressContainer:{width:"80%",marginBottom:20}}),k=({navigation:e})=>{const[t,r]=(0,a.useState)(!1),[o,n]=(0,a.useState)(""),[d,c]=(0,a.useState)(null),[f,b]=(0,a.useState)([]),[p,g]=(0,a.useState)(0),[h,y]=(0,a.useState)(!1);return(0,C.jsxs)(l.default,{style:R.container,children:[(0,C.jsx)(u.default,{style:R.input,placeholder:"Enter Project Name",value:o,onChangeText:n}),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("input",{type:"file",accept:".xsr",onChange:e=>{const t=e.target.files[0];c(t)},style:R.fileInput}),(0,C.jsx)("input",{type:"file",accept:".pdf",multiple:!0,onChange:e=>{const t=Array.from(e.target.files);b(t)},style:R.fileInput})]}),t&&(0,C.jsxs)(l.default,{style:R.progressContainer,children:[(0,C.jsx)(s.default,{children:"Uploading PDF files..."}),(0,C.jsx)(v.default,{styleAttr:"Horizontal",indeterminate:!1,progress:p/100})]}),(0,C.jsx)(i.default,{style:R.button,onPress:async()=>{if(d&&0!==f.length)try{r(!0);const e=await(async e=>{try{const t=(await e.text()).split("\n"),r=[];for(let e=t.findIndex((e=>e&&e.includes("Asmbly Pos.")))+1;e<t.length;e++){const a=t[e]?.trim();if(a&&a.match(/^\S+\s+\d+\s+\S+\s+\S+\s+\d+(\.\d+)?\s+\d+(\.\d+)?$/)){const e=a.split(/\s+/);if(e.length<6)throw new Error(`Invalid line format: ${a}`);const t={POSNO:e[0],Quantity:e[1],Profile:e[3],Weight:e[5],ProjectName:o};r.push(t)}}return r}catch(t){return P.default.alert("Error",`Failed to parse file: ${t.message}`),console.error("Error parsing file:",t),[]}})(d),t=((e,t)=>e.map((e=>{const r=e.POSNO.replace("/",""),a=t.find((t=>{const a=t.fileName.split(" ")[0];return a===r||a===e.POSNO}));return Object.assign({},e,{PdfFileName:a?a.fileName:null,PdfFileURL:a?a.downloadURL:null})})))(e,await(async()=>{const e=(0,O.getStorage)(),t=f.map((t=>new Promise(((r,a)=>{const o=(0,O.ref)(e,`pdfs/${t.name}`),n=(0,O.uploadBytesResumable)(o,t);n.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;g(t)}),(e=>{console.error("Error uploading file:",e),a(e)}),(()=>{(0,O.getDownloadURL)(n.snapshot.ref).then((e=>{r({fileName:t.name,downloadURL:e})}))}))}))));return Promise.all(t)})()),a=(0,m.push)((0,m.ref)(x,"projects/"));await(0,m.set)(a,{projectName:o,records:t}),console.log("Project and records saved to Firebase"),y(!0)}catch(e){console.error("Error saving project to Firebase:",e)}finally{r(!1)}else P.default.alert("Error","Please upload both XSR and PDF files.")},children:(0,C.jsx)(s.default,{style:R.buttonText,children:"Upload Data"})}),h&&(0,C.jsx)(i.default,{style:R.button,onPress:()=>e.navigate("Home"),children:(0,C.jsx)(s.default,{style:R.buttonText,children:"Return to Home"})})]})},I=(0,o.default)(),B=()=>(0,C.jsx)(n.default,{children:(0,C.jsxs)(I.Navigator,{children:[(0,C.jsx)(I.Screen,{name:"Home",component:w}),(0,C.jsx)(I.Screen,{name:"Create Project",component:k})]})}),F=()=>(0,C.jsx)(B,{})}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.m=e,(()=>{var e=[];r.O=(t,a,o,n)=>{if(!a){var l=1/0;for(c=0;c<e.length;c++){for(var[a,o,n]=e[c],s=!0,i=0;i<a.length;i++)(!1&n||l>=n)&&Object.keys(r.O).every((e=>r.O[e](a[i])))?a.splice(i--,1):(s=!1,n<l&&(l=n));if(s){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,o,n]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var o,n,[l,s,i]=a,d=0;if(l.some((t=>0!==e[t]))){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(i)var c=i(r)}for(t&&t(a);d<l.length;d++)n=l[d],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(c)},a=self.webpackChunkweb=self.webpackChunkweb||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=r.O(void 0,[770],(()=>r(7320)));a=r.O(a)})();
//# sourceMappingURL=main.a499a719.js.map
(()=>{"use strict";var e={5208:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var a=r(8548),o=r(5069),n=r(4929),l=r(8597),i=r(2503),s=r(3742),d=r(3052),c=r(5564),f=r(2892),u=r(7062),p=r(4609),b=r(3033),g=r(2144),h=r(4430),m=r(2517),y=r(1973),j=r(5080);const x=(0,r(643).initializeApp)({apiKey:"AIzaSyCsb3TAGK_FLv7rn5hlEwDq6asH6qWzuSA",authDomain:"sbabadag1.firebaseapp.com",databaseURL:"https://sbabadag1-default-rtdb.europe-west1.firebasedatabase.app",projectId:"sbabadag1",storageBucket:"sbabadag1.appspot.com",messagingSenderId:"25031637223",appId:"1:25031637223:web:99256b91a575120d92ca42",measurementId:"G-87LWBM821R"}),C=(0,j.getDatabase)(x);var S=r(6232);const w=c.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",padding:16,backgroundColor:"#f5f5f5"},label:{fontSize:16,fontWeight:"bold",marginBottom:10},button:{backgroundColor:"#007bff",padding:10,borderRadius:5,marginBottom:20,width:"80%",alignItems:"center"},buttonText:{color:"#ffffff",fontSize:16},productionEntryContainer:{width:"80%",flexDirection:"column",alignItems:"center",justifyContent:"space-between",backgroundColor:"#ffffff",padding:10,borderRadius:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:2,elevation:2,marginBottom:20},productionPicker:{width:"100%",marginBottom:10},quantityInput:{height:40,borderColor:"#cccccc",borderWidth:1,padding:10,marginBottom:10,width:"100%"},tableContainer:{width:"100%",marginTop:20,flex:1},scrollContent:{flexGrow:1},table:{width:b.default.get("window").width-32,borderWidth:1,borderColor:"#cccccc",borderRadius:5,backgroundColor:"#ffffff"},tableRow:{flexDirection:"row",flex:1},tableCell:{flex:1,textAlign:"center",fontSize:14,color:"#333333",padding:10,borderRightWidth:1,borderRightColor:"#cccccc",borderBottomWidth:1,borderBottomColor:"#cccccc",justifyContent:"center",alignItems:"center"},tableHeader:{flex:1,textAlign:"center",fontSize:14,color:"#333333",padding:10,borderRightWidth:1,borderRightColor:"#cccccc",borderBottomWidth:1,borderBottomColor:"#cccccc",backgroundColor:"#f0f0f0",fontWeight:"bold",justifyContent:"center",alignItems:"center",color:"red"},separator:{height:1,backgroundColor:"#cccccc",width:"100%"},picker:{height:50,width:"80%",marginBottom:20,marginTop:10},progressContainer:{width:"80%",marginBottom:20,alignItems:"center"},progressBar:{width:"100%",height:10},pdfButton:{backgroundColor:"#007bff",padding:5,borderRadius:5},pdfButtonDisabled:{backgroundColor:"#cccccc"},pdfButtonText:{color:"#ffffff",fontSize:14},loadingContainer:{position:"absolute",top:"50%",left:"50%",transform:[{translateX:-50},{translateY:-50}],alignItems:"center"}}),P=({navigation:e,route:t})=>{const[r,o]=(0,a.useState)([]),[n,c]=(0,a.useState)(""),[b,x]=(0,a.useState)([]),[P,v]=(0,a.useState)(!1),[O,k]=(0,a.useState)(0),[I,R]=(0,a.useState)(0),[B,D]=(0,a.useState)(""),[F,T]=(0,a.useState)("");(0,a.useEffect)((()=>{const e=(0,j.ref)(C,"projects/");(0,j.onValue)(e,(e=>{const r=e.val();if(r){const e=Object.keys(r).map((e=>Object.assign({id:e},r[e])));o(e),t.params?.projectId&&N(t.params.projectId)}}))}),[t.params?.projectId]);const N=e=>{if(c(e),""===e.trim())x([]),k(0),R(0);else{const t=r.find((t=>t.id===e));t&&(x(t.records),k(t.records.reduce(((e,t)=>e+parseFloat(t.Quantity||0)),0)),R(t.records.reduce(((e,t)=>e+parseFloat(t.QuantityDone||0)),0)))}},H=(e,t,a)=>{const o=[...b];o[e][t]=a,x(o);const l=(0,j.ref)(C,`projects/${n}/records/${e}`);(0,j.update)(l,{[t]:a});const i=r.find((e=>e.id===n));i&&(k(i.records.reduce(((e,t)=>e+parseFloat(t.Quantity||0)),0)),R(i.records.reduce(((e,t)=>e+parseFloat(t.QuantityDone||0)),0)))},Q=()=>O?I/O:0,W=({item:e,index:t})=>(0,S.jsxs)(l.default,{style:w.tableRow,children:[(0,S.jsx)(p.default,{style:w.tableCell,value:e.QuantityDone?.toString()||"",onChangeText:e=>H(t,"QuantityDone",e),keyboardType:"numeric"}),(0,S.jsx)(p.default,{style:w.tableCell,value:e.QuantitySent?.toString()||"",onChangeText:e=>H(t,"QuantitySent",e),keyboardType:"numeric"}),(0,S.jsx)(i.default,{style:w.tableCell,children:e.POSNO}),(0,S.jsx)(i.default,{style:w.tableCell,children:e.Quantity}),(0,S.jsx)(i.default,{style:w.tableCell,children:e.Profile}),(0,S.jsx)(i.default,{style:w.tableCell,children:e.Weight}),(0,S.jsx)(d.default,{style:[w.pdfButton,!e.PdfFileURL&&w.pdfButtonDisabled],onPress:()=>(async e=>{v(!0);try{await f.default.openURL(e)}catch(t){console.error("Failed to open URL:",t)}finally{v(!1)}})(e.PdfFileURL),disabled:!e.PdfFileURL,children:(0,S.jsx)(i.default,{style:w.pdfButtonText,children:"PDF A\xe7"})})]});return(0,S.jsxs)(l.default,{style:w.container,children:[(0,S.jsx)(i.default,{style:w.label,children:"Proje Se\xe7"}),(0,S.jsxs)(m.Picker,{selectedValue:n,style:w.picker,onValueChange:e=>N(e),children:[(0,S.jsx)(m.Picker.Item,{label:"Proje Se\xe7",value:""}),r.map((e=>(0,S.jsx)(m.Picker.Item,{label:e.projectName,value:e.id},e.id)))]}),(0,S.jsxs)(l.default,{style:w.progressContainer,children:[(0,S.jsxs)(i.default,{children:["\u0130lerleme: ",Math.round(100*Q()),"%"]}),(0,S.jsx)(y.default,{progress:Q(),style:w.progressBar})]}),(0,S.jsxs)(l.default,{style:w.productionEntryContainer,children:[(0,S.jsxs)(m.Picker,{selectedValue:B,style:w.productionPicker,onValueChange:e=>D(e),children:[(0,S.jsx)(m.Picker.Item,{label:"POSNO Se\xe7",value:""}),r.find((e=>e.id===n))?.records.map((e=>(0,S.jsx)(m.Picker.Item,{label:e.POSNO,value:e.POSNO},e.POSNO)))]}),(0,S.jsx)(p.default,{style:w.quantityInput,value:F,onChangeText:T,placeholder:"Miktar girin",keyboardType:"numeric"}),(0,S.jsx)(g.default,{title:"\xdcretim Ekle",onPress:()=>{if(!B||!F)return void h.default.alert("Hata","L\xfctfen bir POSNO se\xe7in ve bir miktar girin.");const e=r.find((e=>e.id===n));if(e){const t=e.records.findIndex((e=>e.POSNO===B));if(-1!==t){const r=[...e.records];r[t].QuantityDone=parseFloat(r[t].QuantityDone||0)+parseFloat(F),r[t].Date=(new Date).toISOString();const a=(0,j.ref)(C,`projects/${n}/records/${t}`);(0,j.update)(a,{QuantityDone:r[t].QuantityDone,Date:r[t].Date}),x(r),R(r.reduce(((e,t)=>e+parseFloat(t.QuantityDone||0)),0)),T("")}}}})]}),(0,S.jsxs)(s.default,{style:w.tableContainer,contentContainerStyle:w.scrollContent,children:[(0,S.jsxs)(l.default,{style:w.tableRow,children:[(0,S.jsx)(i.default,{style:[w.tableCell,w.tableHeader],children:"Yap\u0131lan Miktar"}),(0,S.jsx)(i.default,{style:[w.tableCell,w.tableHeader],children:"G\xf6nderilen Miktar"}),(0,S.jsx)(i.default,{style:[w.tableCell,w.tableHeader],children:"POSNO"}),(0,S.jsx)(i.default,{style:[w.tableCell,w.tableHeader],children:"Miktar"}),(0,S.jsx)(i.default,{style:[w.tableCell,w.tableHeader],children:"Profil"}),(0,S.jsx)(i.default,{style:[w.tableCell,w.tableHeader],children:"A\u011f\u0131rl\u0131k"}),(0,S.jsx)(i.default,{style:[w.tableCell,w.tableHeader],children:"PDF"})]}),b.map(((e,t)=>W({item:e,index:t}))),P&&(0,S.jsxs)(l.default,{style:w.loadingContainer,children:[(0,S.jsx)(u.default,{size:"large",color:"#007bff"}),(0,S.jsx)(i.default,{children:"PDF Y\xfckleniyor..."})]})]})]})};var v=r(6760),O=r(2526);const k=c.default.create({container:{flexGrow:1,justifyContent:"center",alignItems:"center",padding:16,backgroundColor:"#f5f5f5"},button:{backgroundColor:"#007bff",padding:10,borderRadius:5,marginBottom:20,width:"80%",alignItems:"center"},buttonText:{color:"#ffffff",fontSize:16},fileInput:{marginBottom:20,padding:10,borderWidth:1,borderColor:"#cccccc",borderRadius:5,backgroundColor:"#ffffff"},input:{height:40,borderColor:"#cccccc",borderWidth:1,marginBottom:20,paddingHorizontal:10,width:"80%",borderRadius:5,backgroundColor:"#ffffff"},progressContainer:{width:"80%",marginBottom:20}}),I=({navigation:e})=>{const[t,r]=(0,a.useState)(!1),[o,n]=(0,a.useState)(""),[s,c]=(0,a.useState)(null),[f,u]=(0,a.useState)([]),[b,g]=(0,a.useState)(0),[m,y]=(0,a.useState)(!1);return(0,S.jsxs)(l.default,{style:k.container,children:[(0,S.jsx)(p.default,{style:k.input,placeholder:"Enter Project Name",value:o,onChangeText:n}),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("input",{type:"file",accept:".xsr",onChange:e=>{const t=e.target.files[0];c(t)},style:k.fileInput}),(0,S.jsx)("input",{type:"file",accept:".pdf",multiple:!0,onChange:e=>{const t=Array.from(e.target.files);u(t)},style:k.fileInput})]}),t&&(0,S.jsxs)(l.default,{style:k.progressContainer,children:[(0,S.jsx)(i.default,{children:"Uploading PDF files..."}),(0,S.jsx)(v.default,{styleAttr:"Horizontal",indeterminate:!1,progress:b/100})]}),(0,S.jsx)(d.default,{style:k.button,onPress:async()=>{if(s&&0!==f.length)try{r(!0);const e=await(async e=>{try{const t=(await e.text()).split("\n"),r=[];for(let e=t.findIndex((e=>e&&e.includes("Asmbly Pos.")))+1;e<t.length;e++){const a=t[e]?.trim();if(a&&a.match(/^\S+\s+\d+\s+\S+\s+\S+\s+\d+(\.\d+)?\s+\d+(\.\d+)?$/)){const e=a.split(/\s+/);if(e.length<6)throw new Error(`Invalid line format: ${a}`);const t={POSNO:e[0],Quantity:e[1],Profile:e[3],Weight:e[5],ProjectName:o};r.push(t)}}return r}catch(t){return h.default.alert("Error",`Failed to parse file: ${t.message}`),console.error("Error parsing file:",t),[]}})(s),t=((e,t)=>e.map((e=>{const r=e.POSNO.replace("/",""),a=t.find((t=>{const a=t.fileName.split(" ")[0];return a===r||a===e.POSNO}));return Object.assign({},e,{PdfFileName:a?a.fileName:null,PdfFileURL:a?a.downloadURL:null})})))(e,await(async()=>{const e=(0,O.getStorage)(),t=f.map((t=>new Promise(((r,a)=>{const o=(0,O.ref)(e,`pdfs/${t.name}`),n=(0,O.uploadBytesResumable)(o,t);n.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;g(t)}),(e=>{console.error("Error uploading file:",e),a(e)}),(()=>{(0,O.getDownloadURL)(n.snapshot.ref).then((e=>{r({fileName:t.name,downloadURL:e})}))}))}))));return Promise.all(t)})()),a=(0,j.push)((0,j.ref)(C,"projects/"));await(0,j.set)(a,{projectName:o,records:t}),console.log("Project and records saved to Firebase"),y(!0)}catch(e){console.error("Error saving project to Firebase:",e)}finally{r(!1)}else h.default.alert("Error","Please upload both XSR and PDF files.")},children:(0,S.jsx)(i.default,{style:k.buttonText,children:"Upload Data"})}),m&&(0,S.jsx)(d.default,{style:k.button,onPress:()=>e.navigate("Home"),children:(0,S.jsx)(i.default,{style:k.buttonText,children:"Return to Home"})})]})},R=(0,o.default)(),B=()=>(0,S.jsx)(n.default,{children:(0,S.jsxs)(R.Navigator,{children:[(0,S.jsx)(R.Screen,{name:"Home",component:P}),(0,S.jsx)(R.Screen,{name:"Create Project",component:I})]})}),D=()=>(0,S.jsx)(B,{})}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.m=e,(()=>{var e=[];r.O=(t,a,o,n)=>{if(!a){var l=1/0;for(c=0;c<e.length;c++){for(var[a,o,n]=e[c],i=!0,s=0;s<a.length;s++)(!1&n||l>=n)&&Object.keys(r.O).every((e=>r.O[e](a[s])))?a.splice(s--,1):(i=!1,n<l&&(l=n));if(i){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,o,n]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var o,n,[l,i,s]=a,d=0;if(l.some((t=>0!==e[t]))){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(s)var c=s(r)}for(t&&t(a);d<l.length;d++)n=l[d],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(c)},a=self.webpackChunkweb=self.webpackChunkweb||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=r.O(void 0,[770],(()=>r(7320)));a=r.O(a)})();
//# sourceMappingURL=main.b50d28be.js.map